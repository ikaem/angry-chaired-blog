<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Inexperienced and curious pokes into the sprawling world of web development "/>
    

    <!--Author-->
    
        <meta name="author" content="kaem"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="React Testing with Jest &amp; Enzyme: Unit Testing"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Inexperienced and curious pokes into the sprawling world of web development "/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Angry Chaired Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://ikaem.github.io/angry-chaired-blog/angry-chaired-blog/images/header-image.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://ikaem.github.io/angry-chaired-blog/angry-chaired-blog/images/header-image.jpg"/>
    

    <!-- Title -->
    
    <title>React Testing with Jest &amp; Enzyme: Unit Testing - Angry Chaired Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/angry-chaired-blog/css/style.css">

    
<link rel="stylesheet" href="/angry-chaired-blog/css/custom-style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    
    <link rel="icon" href="/angry-chaired-blog/images/favicon.ico"/>
    

<meta name="generator" content="Hexo 5.0.2"><link rel="alternate" href="/angry-chaired-blog/atom.xml" title="Angry Chaired Blog" type="application/atom+xml">
</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/angry-chaired-blog/">Angry Chaired Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li class="">
                        <a href="/angry-chaired-blog/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li class="">
                        <a href="/angry-chaired-blog/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="">
                        <a href="/angry-chaired-blog/about">
                            
                                About
                            
                        </a>
                    </li>
                
                    <li class="">
                        <a href="/angry-chaired-blog/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li class="icon-label">
                        <a target="_blank" rel="noopener" href="https://angrychaired.surge.sh">
                            
                                <i class="fa fa-user fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
                    <li class="icon-label">
                        <a target="_blank" rel="noopener" href="https://github.com/ikaem/">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
                    <li class="icon-label">
                        <a href="/angry-chaired-blog/atom.xml">
                            
                                <i class="fa fa-rss fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('luke-jones-CEFYNiM9xLk-unsplash.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>React Testing with Jest & Enzyme: Unit Testing</h1>

                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            28/11/2020
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/angry-chaired-blog/categories/react-test-driven-development-with-jest-enzyme/">react test driven development with jest & enzyme</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Step Content Start -->

<h4 id="Part-1-of-2-in-React-Testing-with-Jest-amp-Enzyme"><a href="#Part-1-of-2-in-React-Testing-with-Jest-amp-Enzyme" class="headerlink" title="Part 1 of 2 in React Testing with Jest &amp; Enzyme"></a>Part 1 of 2 in React Testing with Jest &amp; Enzyme</h4><p>I have been learning React testing lately. I wanted to see what all this ‘Test driven development’ thing was, and maybe use it in future projects. This short series is my first attempt to do so, after going over couple tutorials and articles on how to apply it to web development with React.</p>
<a id="more"></a>

<h4 id="See-Project-Information"><a href="#See-Project-Information" class="headerlink" title="See Project Information"></a>See <a href="#Project-Information">Project Information</a></h4><p>From what I understood, TDD is a way to write code.<br>First, one writes code that tests a piece of functionality of a software. When this testing code runs, it will fail, because the functionality is not there yet.<br>Then, one writes code that introduces this functionality. The idea is to write a minimum amount of code that will satisfy the test.<br>Then, the test is run again, and it passes.</p>
<p>As with anything really, there are multiple ways and tools to test React applications.<br>The main paradigm, or a way, it seems, is to write tests in such way that they mimic users actually using the app. This means that we want to test the end result of a piece of code (the UI render), and not the way the code accomplishes the end result (the implementation).<br>As for the tools, the most popular one is Jest. Jest is a test runner - a JS library used to create and run tests. The way I understood it is that it provides its own environment for our code, and then we use various tools to test how is our app present it this Jest-created environment.</p>
<p>When it comes to React, Jest is usually used with other tools that provide an easier way to test React components. One of them is Enzyme, which we will see in action shortly. Other one is React Testing Library, which is what I am learning now. I hope to write a series on that one soon.<br>Enzyme provides a way to mount React components in memory, and then we can use its tools to examine how those components look like.</p>
<p>With the brief intro over, here is a list of things we will cover in this post:</p>
<ol>
<li>App intro and structure</li>
<li>Jest and Enzyme setup</li>
<li>Unit testing of functions and React components</li>
</ol>
<h2 id="Step-1-App-intro-and-structure"><a href="#Step-1-App-intro-and-structure" class="headerlink" title="Step 1: App intro and structure"></a>Step 1: App intro and structure</h2><p>The app we are making is a simple one. It asks use to provide answers to four questions, and then it assembles a sentence from the answers.<br>The app itself was a task I was assigned as a part of a job interview.</p>
<p>The questions are ‘who’, ‘what’, ‘when’, and ‘where’. So assuming a user provides ‘Mark’, ‘plays football’, ‘every Friday’, and ‘at his local playground’ as answers to these questions respectivels, the app would spit out this sentence:</p>
<p><strong>‘Mark plays football every Friday at his local playground</strong>.</p>
<p>Questions and answers are stored in the app as Redux state. It is an array of object, with each object having two properties: ‘question’ and ‘answer’. This is an overkill for such a small app, but it was a task requirement. We will not go into Redux store creation and implementation.</p>
<p>As for the logic of the sentence creation, this is something we will implement as we write tests. We will write the app in such way that we have our tests assume that something is rendered in the UI, and then we will write code that passes the test.</p>
<p>In short, questions are rendered based on local state present in the ‘App’ component. This state (a number) is used by the React Redux’s <strong>useSelector</strong> hook to fetch specific question and its answer from the Redux store.<br>Two buttons present in the app control incrementing and decrementing of the said local state, effectively rendering different questions and answers on each click.</p>
<p>There are five components in the app:</p>
<ol>
<li>App</li>
<li>Header</li>
<li>Answer</li>
<li>Button</li>
<li>Sentence</li>
</ol>
<p>At this point all our components are just drafts, with the following pattern:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ExampleComponent: React.FC = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ExampleComponent;</span><br></pre></td></tr></table></figure>

<p><strong>App</strong> is the component that interacts with Redux state. It also provides needed data and functions to other components. We create it as <strong>App.tsx</strong> in the <strong>src</strong> folder.</p>
<p><strong>Header</strong> provides a way to start a new sentence. It lives in <strong>src\components\header.component.tsx</strong>.</p>
<p><strong>Answer</strong> holds input element into which users type their answers. It lives in <strong>src\components\answer.component.tsx</strong>.</p>
<p><strong>CustomButton</strong> is a UI component, used to switch between questions and start a new sentence. It lives in <strong>src\components\custom-button.component.tsx</strong>.</p>
<p><strong>Sentence</strong> is tasked with rendering currently existing answers as a sentence. It lives in <strong>src\components\sentence.component.tsx</strong>.</p>
<p>When it comes to the app setup, we create it with the ‘create-react-app’ tool. The tool already comes preconfigured with <strong>Jest</strong> support, so we don’t need to do much.<br>In addition to us creating ‘components’, and ‘store’ folders, for React components and Redux parts respectively, we also make a <strong>src/tests</strong> folder. We will use this one to store all test files.</p>
<p>Rest of the needed folders we create as we go.</p>
<h2 id="Step-2-Jest-and-Enzyme-setup"><a href="#Step-2-Jest-and-Enzyme-setup" class="headerlink" title="Step 2: Jest and Enzyme setup"></a>Step 2: Jest and Enzyme setup</h2><p>Since projects created with ‘create-react-app’ already come with Jest support, there is not much to do to get Jest running. If we created our app from scratch, we would have to install Jest, and then ideally configure it to use specific files that configure our testing environment. Skipping all of that now.</p>
<p>Still, we do need to configure <strong>Enzyme</strong>, so let’s do that.<br>To use Enzyme, we need to install three tools:</p>
<ol>
<li>enzyme - the core utility</li>
<li>enzyme adapter for react - a utility that tells enzyme what type of code to expect.</li>
</ol>
<p>Note that the adapter is specific to the React version we use in our project. Since our app uses React 17+, we should install an adapter for that version. However, it seems that no official adapter for React 17 has been released, so we are using an unofficial one - <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@wojtekmaj/enzyme-adapter-react-17?activeTab=readme">@wojtekmaj/enzyme-adapter-react-17</a>.</p>
<p>Since I use TypeScript to write the app, types for Enzyme utility are also needed.<br>We install all of it as dev dependencies:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D enzyme @wojtekmaj/enzyme-adapter-react-17 @types/enzyme</span><br></pre></td></tr></table></figure>

<p>Last thing to do before we actually start testing is a convenience thing.</p>
<p>To use Enzyme to test React components, we need to configure Enzyme each time we use it.<br>This means that we would have to import its <strong>configure</strong> method in each test file (and we will have several of those), and then pass it an instance of the <strong>Adapter</strong> class from the enzyme package we installed.<br>As this can be tedious, Jest and React together provide a way for this to be one only once - in a <strong>setupTests.ts</strong> file that comes with a ‘create-react-app’ in the <strong>src</strong> folder.<br>If the file is not there, we just create it with this exact name.</p>
<p>Inside, we import the said ‘configure’ method from the ‘enzyme’ package, and the ‘Adapter’ class from the Enzyme adapter package.</p>
<p>Then, we call the ‘configure’ method with an object holding <strong>adapter</strong> property initialized to an instance of the ‘Adapter’ class:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\setupTests.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; configure &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> Adapter <span class="keyword">from</span> <span class="string">&quot;@wojtekmaj/enzyme-adapter-react-17&quot;</span>;</span><br><span class="line"></span><br><span class="line">configure(&#123; <span class="attr">adapter</span>: <span class="keyword">new</span> Adapter() &#125;);</span><br></pre></td></tr></table></figure>

<p>This setup configures Enzyme, and we can now use its APIs to test the app.</p>
<h2 id="3-Unit-testing-of-functions-and-React-components"><a href="#3-Unit-testing-of-functions-and-React-components" class="headerlink" title="3. Unit testing of functions and React components"></a>3. Unit testing of functions and React components</h2><p>We will start our testing with unit tests.<br>Unit tests are used to test individual pieces of code independently from other code in the app.<br>Usually, the units are functions, or, as in our case, React components.<br>In this post we will test both functions and components.</p>
<p>Unit testing assumes testing units in isolations, meaning that we have to manually supply functions and components with needed data such as arguments and props.<br>Benefit of unit testing is that we focus on one thing, and work on it until it works.</p>
<p>Other types of tests are integration and end-to-end tests.<br>Integration tests use several pieces of code, such as several components, to test if they interact in a correct way.<br>We will do integration tests in the next post.<br>End-to-end tests take the entire app into condideration, including; I assume, both frontend and backend. We will not do these in this series.</p>
<p>The way I see a test is like a plan for what I want an app to do. I have to admit that it was fairly easy for me to write the app in the TDD approach, because I always followed the same pattern of thinking:</p>
<ol>
<li>I write test to document what I want to be (happen, render, calculate) in the app.</li>
<li>The test fails</li>
<li>I write code to make the test pass. At this point I don’t have to think what I want the app to do. I just worry about passing the test.</li>
<li>I run the test again and again until it passes.</li>
</ol>
<p>With this in mind, here is what we want each component of our app to do:</p>
<p><strong>Answer</strong></p>
<ol>
<li>Renders without error</li>
<li>Does not render when ‘App’ component tells it not to render</li>
<li>Renders current question correctly</li>
<li>Renders current answer correctly</li>
<li>Calls a function that sets answer to the current question</li>
</ol>
<p><strong>Custom Button</strong></p>
<ol>
<li>Renders without error</li>
<li>Does not render when ‘App’ component tells it not to render</li>
<li>Renders it label correctly</li>
<li>Calls its <strong>onClick</strong> function when clicked</li>
<li>Is disabled in case when used as a button to move onto to the next question, but the conditions to move are not met</li>
</ol>
<p><strong>Sentence</strong></p>
<ol>
<li>Renders without error</li>
<li>Renders the existing sentence</li>
<li>Does not render an ellipsis when the sentence is complete</li>
<li>Renders ellipsis when the sentence is not complete</li>
</ol>
<p><strong>Redux store</strong> - functions testing</p>
<ol>
<li>The action creator to provide an action for new answer returns a specific object</li>
<li>Questions reducer returns a specific state when provided with an action</li>
</ol>
<p>We can notice few things:</p>
<ol>
<li>Testing is dividided into individual React components, or individual functions for Redux store. This is the point of unit testing - we test these units in isolation</li>
<li>We are missing ‘App’ and ‘Header’ components. We will do ‘App’ component in the next post, because of a specific setup involving Redux. ‘Header’ component is fairly simple, and its tests would involve repeating of what we do in other tests, so we will skip it.</li>
</ol>
<p>Before we jump into unit tests, lest do a brief test run,on how tests work.</p>
<p>First thing we do is to initialize a Git repository:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>

<p>Projects created with <strong>create-react-app</strong> should come with a create <strong>.gitignore</strong> file. If not there, we create one an put the <strong>/node_modules</strong> entry in it, so out commits don’t add that huge file into the repository<br>Then we add existing changed files to the commit queue and commit those changes.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;initial commit&quot;</span><br></pre></td></tr></table></figure>

<p>We initialize a Git repo to help Jest make distinction between tests that were done before and after commiting changes. This way Jest will not show state of those tests that were made before the newest commit, unlese, ofcourse, they are changed or if Jest is explicitely told to show them.</p>
<p>Now, let’s create a file in the <strong>src/tests</strong> folder, and call it <strong>example.test.ts</strong><br>The <strong>.test.ts</strong> part of the name is key. Jest looks for all files with this extension and includes it in its tests.</p>
<p>We create our first test to see if <strong>true</strong> is <strong>true</strong>.<br>This is the code:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\example.test.ts</span></span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(<span class="literal">true</span>).toBe(<span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>Few things to note:</p>
<ol>
<li>I export an empty object because TypeScript’s project setup requires modules to import or export something. This is not related to testing.</li>
<li>We make tests by using a <strong>test</strong> method. This method is provided by Jest and is globally available in the app. The method takes two arguments: a string that describes our test, and a callback function in which we detail the dest</li>
<li>In this simple case, we tell the test that we expect <strong>true</strong> to be <strong>true</strong>. This is called assertion, and is commonly done via <strong>expect</strong> method. The <strong>expect</strong> method is also globally available via Jest.</li>
<li>The <strong>expect</strong> method accepts an argument and returns an expectation object - a value resolved from its argument. The argument can be a function, string, number, or, as in our case, a boolean.</li>
<li>The <strong>toBe()</strong> method is called a matcher. It chains onto the <strong>expect</strong> method, and tests the expectation object against its own arugment. There are many matchers. In this case, <strong>toBe</strong> is used to test <strong>exact</strong> equality - <strong>true</strong>, indeed, is true.</li>
</ol>
<p>To actually have Jest perform the test we just wrote, we need to start it.<br>With our <strong>create-react-setup</strong>, we just need to call <strong>test</strong> script in the terminal:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>After few moments, we get a nice output in the terminal indicating that the test has passed:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PASS  src/tests/example.test.ts</span><br><span class="line">√ see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span> (<span class="number">1</span> ms)</span><br><span class="line"></span><br><span class="line">Test Suites: <span class="number">1</span> passed, <span class="number">1</span> total</span><br><span class="line">Tests:       <span class="number">1</span> passed, <span class="number">1</span> total</span><br><span class="line">Snapshots:   <span class="number">0</span> total</span><br><span class="line">Time:        <span class="number">4.858</span> s</span><br><span class="line">Ran all test suites related to changed files.</span><br><span class="line"></span><br><span class="line">Watch Usage: Press w to show more.</span><br></pre></td></tr></table></figure>

<p>But, remember that we said that each test should fail first. This is because we need to make sure that our tests fail and pass because of the code we write to make them fail or pass. We don’t want to accidentally fail or pass a test.</p>
<p>So let’s make the test fail.<br>The easiest way to do it would be to assert that <strong>true</strong> is <strong>false</strong>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\example.test.ts</span></span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(<span class="literal">true</span>).toBe(<span class="literal">false</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>And boom, just like that, our test fails. Since Jest is still active and running our tests (unless we shut it down), we see an ugly output in the terminal.<br>It tells us that the test failed, but it also tells us that our actions made the test fail, which is good.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/example.test.ts</span><br><span class="line">× see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span> (<span class="number">4</span> ms)</span><br><span class="line"></span><br><span class="line">● see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">  Expected: <span class="literal">false</span></span><br><span class="line">  Received: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="number">2</span> |</span><br><span class="line">    <span class="number">3</span> | test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  &gt; <span class="number">4</span> |   expect(<span class="literal">true</span>).toBe(<span class="literal">false</span>);</span><br><span class="line">      |                ^</span><br><span class="line">    <span class="number">5</span> | &#125;);</span><br><span class="line">    <span class="number">6</span> |</span><br><span class="line">    <span class="number">7</span> | <span class="keyword">export</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/example.test.ts:<span class="number">4</span>:<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">Test Suites: <span class="number">1</span> failed, <span class="number">1</span> total</span><br><span class="line">Tests:       <span class="number">1</span> failed, <span class="number">1</span> total</span><br><span class="line">Snapshots:   <span class="number">0</span> total</span><br><span class="line">Time:        <span class="number">4.824</span> s</span><br><span class="line">Ran all test suites related to changed files.</span><br><span class="line"></span><br><span class="line">Watch Usage: Press w to show more.</span><br></pre></td></tr></table></figure>

<p>Note that the output provided is very helpful:</p>
<ul>
<li>We can see which test failed, and in which file:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FAIL src/tests/example.test.ts</span><br><span class="line">× see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span> (<span class="number">4</span> ms)</span><br></pre></td></tr></table></figure>

<ul>
<li>We see what failed, in form of what was expected and what was received:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">● see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">    Expected: <span class="literal">false</span></span><br><span class="line">    Received: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>We see where in the code the problem happened:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">2</span> |</span><br><span class="line">  <span class="number">3</span> | test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">&gt; <span class="number">4</span> |   expect(<span class="literal">true</span>).toBe(<span class="literal">false</span>);</span><br><span class="line">    |                ^</span><br><span class="line">  <span class="number">5</span> | &#125;);</span><br><span class="line">  <span class="number">6</span> |</span><br><span class="line">  <span class="number">7</span> | <span class="keyword">export</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/example.test.ts:<span class="number">4</span>:<span class="number">16</span>)</span><br></pre></td></tr></table></figure>

<p>Let’s test a function now.<br>Create a function called <strong>addTwo</strong> in the same file. It is should take a number as an argument, add 2 to the argument, and return the result.<br>For now, though, we will just have it return 2 - the variable initialised in the function.<br>Then we test the function to see if it returns the correct answer:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\example.test.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addTwo = <span class="function">(<span class="params">num: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> two = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> two;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// expect(true).toBe(false);</span></span><br><span class="line">  <span class="keyword">const</span> num = <span class="number">4</span>;</span><br><span class="line">  expect(addTwo(arg)).toBe(<span class="number">6</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>Obviously, this fails, as the number 2 returned by the function is not equal to 6.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/example.test.ts</span><br><span class="line"> × see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span> (<span class="number">7</span> ms)</span><br><span class="line"></span><br><span class="line"> ● see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">   expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">   Expected: <span class="number">6</span></span><br><span class="line">   Received: <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>A fix is is needed, and we do it by adding the argument to the variable initialized in our function:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\example.test.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addTwo = <span class="function">(<span class="params">num: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> two = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> two + num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;see if true is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// expect(true).toBe(false);</span></span><br><span class="line">  <span class="keyword">const</span> num = <span class="number">4</span>;</span><br><span class="line">  expect(addTwo(num)).toBe(<span class="number">6</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>With this, the test passes:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> PASS  src/tests/example.test.ts</span><br><span class="line">  √ see <span class="keyword">if</span> <span class="literal">true</span> is <span class="literal">true</span> (<span class="number">2</span> ms)</span><br><span class="line"></span><br><span class="line">Test Suites: <span class="number">1</span> passed, <span class="number">1</span> total</span><br><span class="line">Tests:       <span class="number">1</span> passed, <span class="number">1</span> total</span><br><span class="line">Snapshots:   <span class="number">0</span> total</span><br><span class="line">Time:        <span class="number">5.928</span> s</span><br><span class="line">Ran all test suites related to changed files.</span><br></pre></td></tr></table></figure>

<p>Let’s move onto testing components and functions needed for our React app.</p>
<h3 id="Answer-Component"><a href="#Answer-Component" class="headerlink" title="Answer Component"></a>Answer Component</h3><p>The ‘Answer’ component is tasked with rendering an input element, and passing value of the input to the Redux state via App component. Since we are focused on unit testing in this post, we will not be testing this Answer-App-Redux connection just yet.<br>Instead, we want to make sure that the ‘Answer’ component is capable of doing its job by testing it in isolation. We will do this by asserting that the component does somethig, and then tweak it until it actually does it.</p>
<p>Here is what we need the ‘Answer’ component to do:</p>
<ol>
<li>Renders without error</li>
<li>Does not render when ‘App’ component tells it not to render</li>
<li>Renders current question correctly</li>
<li>Renders current answer correctly</li>
<li>Calls a function that sets answer to the current question</li>
</ol>
<p>We will start with general setup for ‘Answer’s tests, and then write the actual tests.</p>
<p>First, we create a file called <strong>answer.test.tsx</strong>, and place it inside the <strong>src/tests</strong> folder.<br>We <strong>answer</strong> part of the filename is flexibile, and I specified it like that to make clear that this test is related to the ‘Answer’ component.<br>The <strong>test.tsx</strong> part, however, is mandatory. We already established that Jest will look at all files in our project, and then include the <strong>test</strong> ones in its tests. The <strong>.tsx</strong> part has to do with React, from what I understand. Since our test will involve rendering of actual JSX, even if it is in memory only, TypeScript requires the extension of any such file to be <strong>.tsx</strong>.</p>
<p>Now, inside the file, we will import two things:</p>
<ol>
<li>The component we will be testing - ‘Answer’ in this case</li>
<li><strong>shallow</strong> method from the ‘enzyme’ package.</li>
</ol>
<p>The <strong>shallow</strong> method is used to render a React component in memory. The special thing about it is that it renders only the component we pass to it. This means that it does not render content of any other component that might be nested inside the passed component. Instead, it will put a placeholder in place of any nested component to indicate that there is a component here, but this is as far as it will go.</p>
<p><strong>shallow</strong> is good for unit testing because we only want to focus on one component, and ignore any other components connected to it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\answer.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; shallow &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Answer <span class="keyword">from</span> <span class="string">&quot;../components/answer.component&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>Next, we will create a test suite. Test suite is a container for tests, used to group related tests together. Inside a suite, we can create certain variables and function that will be used only by its tests. Outside a suite, we can create another suite to house other tests that work with some other functionalities of the app.</p>
<p>To create a suite, we call <strong>describe</strong> function, made globally available by Jest, and pass it a string and a callback function.<br>The string describes this specific group of tests, and the callback function houses this suite’s tests.</p>
<p>In this case, we are making a simple suite and pass it <strong>“Answer”</strong> string to indicate that its tests will be related to the ‘Answer’ component.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\answer.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; shallow &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Answer <span class="keyword">from</span> <span class="string">&quot;../components/answer.component&quot;</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// tests go here</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Great. Now we can write tests.</p>
<h4 id="Test-that-‘Answer’-component-enders-without-error"><a href="#Test-that-‘Answer’-component-enders-without-error" class="headerlink" title="Test that ‘Answer’ component enders without error"></a>Test that ‘Answer’ component enders without error</h4><p>To test that the component renders without error, we assume that there is content inside it. By content, I mean HTML elements, but we can also test for actual text content.</p>
<p>First thing to do is to actually create a test, and then render a component we want to test.<br>We know that we create tests with the <strong>test()</strong> method (we can also use <strong>it()</strong> method instead).<br>We render the component with the <strong>shallow()</strong> method, to which we pass the component.</p>
<p>Here is the code:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  test(<span class="string">&quot;renders without error&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> /&gt;</span></span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Great. With this, we have the component shallowly rendered in memory. So, what now? Well, let’s see what it is that is actually rendered.<br>We can do this with the <strong>debug()</strong> method available on the <strong>wrapper</strong> object returned by the <strong>shallow</strong> method.</p>
<p>We will just log it:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  test(<span class="string">&quot;renders without error&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> /&gt;</span></span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;logged wrapper:&quot;</span>, wrapper.debug());</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And get the following output in the terminal:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PASS  src/tests/answer.test.tsx (<span class="number">5.244</span> s)</span><br><span class="line"> ● Console</span><br><span class="line"></span><br><span class="line">   <span class="built_in">console</span>.log</span><br><span class="line">     logged wrapper: <span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/answer.test.tsx:<span class="number">20</span>:<span class="number">13</span>)</span><br></pre></td></tr></table></figure>

<p>We notice two things:</p>
<ol>
<li>Our test actually passes. Jest has successfuly rendered the ‘Answer’ component, and, because did not expect anything else from the test, no error was thrown and the test passed.</li>
<li>The output from <strong>console.log</strong> is a simple <strong>div</strong> element. This is because this is the only thing we have in the component at this point.</li>
</ol>
<p>Let’s assume we have more stuff in the component. Let’s assume there is a <strong>div</strong> element in the component, and that it has a <strong>data</strong> attribute with the value of <strong>component-answer</strong>.<br>To do this, we will find this element, and then we will assert that the length of all such elments is 1.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  test(<span class="string">&quot;renders without error&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> /&gt;</span></span>)</span><br><span class="line">    <span class="keyword">const</span> component = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-answer&#x27;]&quot;</span>);</span><br><span class="line">    expect(component.length).toBe(<span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>To find an element in the component, we call <strong>find()</strong> method on the <strong>wrapper</strong> object. <strong>find()</strong> method accepts a css-like argument, which it uses to find an element (or an entire component). In this case, we pass it a value of <strong>“[data-test=’component-answer’]”</strong>, to indicate that we want an elements with data-test attribute of <strong>‘component-answer’</strong>.</li>
<li>To assert that this element exists in the component, we use <strong>expect</strong> method, to which we pass the selected element’s length. Then we chain <strong>toBe</strong> method onto it, and we pass it the expected length. In this case, we expect the lenght to be 1.</li>
</ol>
<p>If we run the test, we will notice that it fails:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/answer.test.tsx (<span class="number">5.38</span> s)</span><br><span class="line"> ● Answer › renders without error</span><br><span class="line"></span><br><span class="line">   expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">   Expected: <span class="number">1</span></span><br><span class="line">   Received: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">     <span class="number">20</span> |     <span class="built_in">console</span>.log(<span class="string">&quot;logged wrapper:&quot;</span>, wrapper.debug());</span><br><span class="line">     <span class="number">21</span> |     <span class="keyword">const</span> component = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-answer&#x27;]&quot;</span>);</span><br><span class="line">   &gt; <span class="number">22</span> |     expect(component.length).toBe(<span class="number">1</span>);</span><br><span class="line">        |                              ^</span><br><span class="line">     <span class="number">23</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/answer.test.tsx:<span class="number">22</span>:<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<p>This is expected. At the moment we have no such element in our component, so the ‘Received’ value is 0, which is visibile in the test ouput.</p>
<p>We fix this by adding such element in the ‘Answer’ component:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\answer.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Answer: React.FC = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-test</span>=<span class="string">&quot;component-answer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>We save and Jest runs the test again. And it passes. So our component now does render without error. Great.</p>
<h4 id="‘Answer’-component-does-not-render-when-‘App’-component-tells-it-not-to-render"><a href="#‘Answer’-component-does-not-render-when-‘App’-component-tells-it-not-to-render" class="headerlink" title="‘Answer’ component does not render when ‘App’ component tells it not to render"></a>‘Answer’ component does not render when ‘App’ component tells it not to render</h4><p>By “‘App’ component tells it not to render”, I mean that App component will eventually pass a prop to ‘Answer’ component to control whether ‘Answer’ renders or not. Eventually. In the test, we are the ones providing the prop, and control rendering of the component.</p>
<p>So let’s create another test.<br>Again, we create a test, describe it, create a wrapper, select a component element, and assert that the element’s length is 0. We go with 0 this time, because we expect the component not to render.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ..</span></span><br><span class="line">  test(<span class="string">&quot;does not render when &#x27;isNotRendered&#x27; prop is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      isNotRendered: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>);</span><br><span class="line">    <span class="keyword">const</span> component = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-answer&#x27;]&quot;</span>);</span><br><span class="line">    expect(component.length).toBe(<span class="number">0</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>We create a <strong>props</strong> object, which we then spread inside the ‘Answer’ component. This is what I mean when I say that we manually provide props to the component.</li>
<li>We control the render via <strong>isNotRendered</strong> prop. This is explicitely stated in the test description, so the test is immediately understandable whenever we look at it.</li>
</ol>
<p>Again, this test fails, because the component still renders.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/answer.test.tsx</span><br><span class="line"> ● Answer › does not render when <span class="string">&#x27;isNotRendered&#x27;</span> prop is <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">   expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">   Expected: <span class="number">0</span></span><br><span class="line">   Received: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">     <span class="number">29</span> |     <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>);</span><br><span class="line">     <span class="number">30</span> |     <span class="keyword">const</span> component = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-answer&#x27;]&quot;</span>);</span><br><span class="line">   &gt; <span class="number">31</span> |     expect(component.length).toBe(<span class="number">0</span>);</span><br><span class="line">        |                              ^</span><br><span class="line">     <span class="number">32</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/answer.test.tsx:<span class="number">31</span>:<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<p>In fact, we also get an error warning from TypeScript, telling us that the ‘Answer’ component does not expect the <strong>isNotRendered</strong> prop.<br>We fail miserably here. Very good.</p>
<p>Let’s fix this.<br>We need to make sure that the component actually expects the prop, and that the component does not render when such prop is true.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\answer.component.tsx</span></span><br><span class="line"></span><br><span class="line">interface AnswerProps &#123;</span><br><span class="line">  isNotRendered: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Answer: React.FC&lt;AnswerProps&gt; = <span class="function">(<span class="params">&#123; isNotRendered &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-test</span>=<span class="string">&quot;component-answer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Boom. Just like that, the test passes.</p>
<p>Now, common practice seems to be to create a function that takes care of creating the wrapper component. Then we just call this function every time we create a new test.<br>Here is the function and its use in the last test. We also pass it default props, so we don’t have to worry about those every time we create a wrapper.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\answer.test.tsx</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setup = <span class="function">(<span class="params">testProps = defaultProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Answer</span> &#123;<span class="attr">...testProps</span>&#125; /&gt;</span></span>);</span><br><span class="line">  <span class="keyword">return</span> wrapper;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  test(<span class="string">&quot;does not render when &#x27;isNotRendered&#x27; prop is true&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      ...defaultProps,</span><br><span class="line">      isNotRendered: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">    <span class="keyword">const</span> component = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-answer&#x27;]&quot;</span>);</span><br><span class="line">    expect(component.length).toBe(<span class="number">0</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Another thing that we mentioned before is commiting to git after each successfull test. So let’s do that before we move on.</p>
<h4 id="3-Renders-current-question-correctly"><a href="#3-Renders-current-question-correctly" class="headerlink" title="3. Renders current question correctly"></a>3. Renders current question correctly</h4><p>Our ‘Answer’ component is tasked with rendering the current question to which the user provides an answer.<br>We will render this question in the <strong>label</strong> element (which might not be the best solution).<br>Before we do that, though, let’s write a test that checks whether a question is actually rendered there.</p>
<p>Similar to the previous test, we will use a prop to deliver info into the component.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">  question: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  test(<span class="string">&quot;renders &#x27;question&#x27; prop correctly&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      ...defaultProps,</span><br><span class="line">      question: <span class="string">&quot;What?&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">    <span class="keyword">const</span> label = wrapper.find(<span class="string">&quot;label&quot;</span>);</span><br><span class="line">    expect(label.text()).toBe(<span class="string">&quot;What?&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>We have a prop <strong>question</strong>, which will get passed to the component.</li>
<li>We use <strong>find()</strong> to select the label in the component. We will have only one label in the component, so this is fine. Notice that we find the element by passing <strong>label</strong> string to the <strong>find()</strong> method. This mimicks the css query selectors - we select label element.</li>
<li>We use <strong>text()</strong> method on the found ‘label’ object, to fetch text contents in the element. The method will fetch all text in the element on which it was called, regardless of how maby nested elements there are.</li>
<li>I also added <strong>question</strong> prop into the <strong>defaultProps</strong> object, and gave it falue of empty string. This is just so we can later make sure that the test actually fails.</li>
</ol>
<p>Of course, this test fails:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> FAIL  src/tests/answer.test.tsx</span><br><span class="line">  Answer</span><br><span class="line">    √ renders without error (<span class="number">18</span> ms)</span><br><span class="line">    √ does not render when <span class="string">&#x27;isNotRendered&#x27;</span> prop is <span class="literal">true</span> (<span class="number">2</span> ms)</span><br><span class="line">    × renders <span class="string">&#x27;question&#x27;</span> prop correctly (<span class="number">3</span> ms)</span><br><span class="line"></span><br><span class="line">  ● Answer › renders <span class="string">&#x27;question&#x27;</span> prop correctly</span><br><span class="line"></span><br><span class="line">    Method “text” is meant to be run on <span class="number">1</span> node. <span class="number">0</span> found instead.</span><br><span class="line"></span><br><span class="line">      <span class="number">46</span> |     <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">      <span class="number">47</span> |     <span class="keyword">const</span> label = wrapper.find(<span class="string">&quot;label&quot;</span>);</span><br><span class="line">    &gt; <span class="number">48</span> |     expect(label.text()).toBe(<span class="string">&quot;What?&quot;</span>);</span><br><span class="line">         |                  ^</span><br><span class="line">      <span class="number">49</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">      at ShallowWrapper.single (node_modules/enzyme/src/ShallowWrapper.js:<span class="number">1652</span>:<span class="number">13</span>)</span><br><span class="line">      at ShallowWrapper.text (node_modules/enzyme/src/ShallowWrapper.js:<span class="number">1093</span>:<span class="number">17</span>)</span><br><span class="line">      at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/answer.test.tsx:<span class="number">48</span>:<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">Test Suites: <span class="number">1</span> failed, <span class="number">1</span> total</span><br><span class="line">Tests:       <span class="number">1</span> failed, <span class="number">2</span> passed, <span class="number">3</span> total</span><br><span class="line">Snapshots:   <span class="number">0</span> total</span><br><span class="line">Time:        <span class="number">5.561</span> s</span><br><span class="line">Ran all test suites related to changed files.</span><br><span class="line"></span><br><span class="line">Watch Usage: Press w to show more.</span><br></pre></td></tr></table></figure>

<p>There are few issues with the current implementation of the ‘Answer’ component that make the test fail:</p>
<ol>
<li>As the test output suggests, the component has no ‘label’ element on which the <strong>text()</strong> method should run.</li>
<li>Because of the first issue, there is text value on the ‘label’ element.</li>
<li>The ‘Answer’ component does not expect a <strong>question</strong> prop.</li>
</ol>
<p>So let’s fix the component to pass this test:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\answer.component.tsx</span></span><br><span class="line"></span><br><span class="line">interface AnswerProps &#123;</span><br><span class="line">  isNotRendered: boolean;</span><br><span class="line">  question: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Answer: React.FC&lt;AnswerProps&gt; = <span class="function">(<span class="params">&#123; isNotRendered, question &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div data-test=<span class="string">&quot;component-answer&quot;</span>&gt;</span><br><span class="line">      &lt;h2&gt;Answer questions to create your sentence&lt;/h2&gt;</span><br><span class="line">      &lt;form&gt;</span><br><span class="line">        &lt;label htmlFor=<span class="string">&quot;answer&quot;</span>&gt;&#123;question&#125;&lt;/label&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>With this setup, the test passes. So we move on.</p>
<h4 id="‘Answer’-component-renders-current-answer-correctly"><a href="#‘Answer’-component-renders-current-answer-correctly" class="headerlink" title="‘Answer’ component renders current answer correctly"></a>‘Answer’ component renders current answer correctly</h4><p>Similar to what we did in the previous test, we now want to make sure that the ‘input’ element of the ‘Answer’ component renders current answer correctly.<br>By ‘current’ answer, I mean the value of the <strong>answer</strong> property for each <strong>question</strong> object in the Redux state of the app. So, if this particular property is an empty string, the ‘input’ should render an empty string. If the value is a valid string, well, we get to see whatever the current answer is.</p>
<p>So here is the test, together with the default prop of <strong>answer</strong> added to the <strong>defaultProps</strong> object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\answer.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">  question: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  test(<span class="string">&quot;passes &#x27;answer&#x27; prop to &#x27;input&#x27; element corectly&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      ...defaultProps,</span><br><span class="line">      answer: <span class="string">&quot;plays football&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.find(<span class="string">&quot;input&quot;</span>);</span><br><span class="line"></span><br><span class="line">    expect(input.prop(<span class="string">&quot;value&quot;</span>)).toBe(props.answer);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>One thing to note:</p>
<ol>
<li>Here we expect that the <strong>prop</strong> method with <strong>“value”</strong> string passed to it returns value that equals that of the <strong>props.answer</strong>. The <strong>prop</strong> method can return any prop or attribute on an elemement or a component. There is also a <strong>props()</strong> method, which returns an object with all avaialble props. So if we wanted to access the <strong>value</strong> prop via <strong>props()</strong> method, we would write the following assertion:</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expect(input.props().value).toBe(props.answer);</span><br></pre></td></tr></table></figure>

<p>As usual, the test fails. We dont have an ‘input’ element in the component, nor does the component expect the <strong>answer</strong> prop to be passed to it.<br>The fix is easy:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\answer.component.tsx</span></span><br><span class="line"></span><br><span class="line">interface AnswerProps &#123;</span><br><span class="line">  isNotRendered: boolean;</span><br><span class="line">  question: string;</span><br><span class="line">  answer: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Answer: React.FC&lt;AnswerProps&gt; = <span class="function">(<span class="params">&#123; isNotRendered, question, answer &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div data-test=<span class="string">&quot;component-answer&quot;</span>&gt;</span><br><span class="line">      &lt;h2&gt;Answer questions to create your sentence&lt;/h2&gt;</span><br><span class="line">      &lt;form&gt;</span><br><span class="line">        &lt;label htmlFor=<span class="string">&quot;answer&quot;</span>&gt;&#123;question&#125;&lt;/label&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">&quot;text&quot;</span></span><br><span class="line">          id=<span class="string">&quot;answer&quot;</span></span><br><span class="line">          name=<span class="string">&quot;answer&quot;</span></span><br><span class="line">          value=&#123;answer&#125;</span><br><span class="line">          onChange=&#123;<span class="function">() =&gt;</span> &#123;&#125;&#125;</span><br><span class="line">          placeholder=&#123;<span class="string">&quot;An answer, please...&quot;</span>&#125;</span><br><span class="line">          required</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="The-input-element-calls-a-function-that-sets-answer-to-the-current-question"><a href="#The-input-element-calls-a-function-that-sets-answer-to-the-current-question" class="headerlink" title="The input element calls a function that sets answer to the current question"></a>The input element calls a function that sets answer to the current question</h4><p>Usually, when there is a change in the value of the input element, a function is called that stores the new value into whatever state controls the said input.<br>Here, we want to test that this function is actually called when a user types something into an input.<br>Note that we do not test the state that controls the input. For this app, this state will live in the ‘App’ component, which is not part of the ‘Answer’ unit testing. Instead, we just want to test that the function passed to the ‘Answer’ component, tasked with setting the said state, is actually called.</p>
<p>Here is the code, together with a placeholder <strong>onHandleChange</strong> function added to the <strong>defaultProps</strong> object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\answer.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">  question: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  onHandleChange: <span class="function">(<span class="params">event: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Answer&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  test(<span class="string">&quot;calls &#x27;onHandleChange&#x27; when typing inside the input&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> mockEvent = &#123;</span><br><span class="line">      target: &#123;</span><br><span class="line">        value: <span class="string">&quot;Mark&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      ...defaultProps,</span><br><span class="line">      onHandleChange: jest.fn(),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.find(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    input.simulate(<span class="string">&quot;change&quot;</span>, mockEvent);</span><br><span class="line"></span><br><span class="line">    expect(props.onHandleChange).toHaveBeenCalledTimes(<span class="number">1</span>);</span><br><span class="line">    expect(props.onHandleChange).toHaveBeenCalledWith(mockEvent);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>In the test, we create <strong>mockEvent</strong> object, with <strong>value</strong> property nested inside the <strong>target</strong> property. This structure and key names mimic the shape of the event object passed from to the handler function, where value of the input is stored inside the <strong>event.target.value</strong> property. The idea here is that, when we simulate a change on an imput element, this pseudo-event will be used as an event object, and passed to the hanler function.</li>
<li>After we select an element, we simulate an event on it. To do this, we use the <strong>simulate</strong> method on an element, and pass it a string to indicate which event we want to simulate, and optionally, an event object that we want to pass to the handler of the said event. In our case, this changes value of the input to <strong>“Mark”</strong>.</li>
<li>We have also created <strong>onHandleChange</strong> method inside the <strong>props</strong> object, and assigned it the value of <strong>jest.fn()</strong>. <strong>jest.fn()</strong> is a mock function, a Jest method specialized in replacing real functions, and then allowing inspection of behavior of said functions. It is said that by mocking a function, we spy on the original function. The idea here is that we will replace the original <strong>onHandleChange</strong> prop with this mock function, and then check to see if the mock was called, and what were the arguments passed to it.</li>
<li>Which is exactly what we do - we assert that the mock was called once, and that the change event (our <strong>mockEvent</strong> object) was passed to it when it was called. Notice that we have 2 assertions in the same test. This is ok. Both assertions have to yield <strong>true</strong> for the test to pass.</li>
</ol>
<p>Again, our test initiall fails.<br>We need to make sure that the component expects the <strong>onHandleChange</strong> props, and that it actually calls the prop when value on the input changes:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\answer.component.tsx</span></span><br><span class="line"></span><br><span class="line">interface AnswerProps &#123;</span><br><span class="line">  isNotRendered: boolean;</span><br><span class="line">  question: string;</span><br><span class="line">  answer: string;</span><br><span class="line">  onHandleChange: <span class="function">(<span class="params">event: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;</span> <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Answer: React.FC&lt;AnswerProps&gt; = (&#123;</span><br><span class="line">  isNotRendered,</span><br><span class="line">  question,</span><br><span class="line">  answer,</span><br><span class="line">  onHandleChange,</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div data-test=<span class="string">&quot;component-answer&quot;</span>&gt;</span><br><span class="line">      &lt;h2&gt;Answer questions to create your sentence&lt;/h2&gt;</span><br><span class="line">      &lt;form&gt;</span><br><span class="line">        &lt;label htmlFor=<span class="string">&quot;answer&quot;</span>&gt;&#123;question&#125;&lt;/label&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">&quot;text&quot;</span></span><br><span class="line">          id=<span class="string">&quot;answer&quot;</span></span><br><span class="line">          name=<span class="string">&quot;answer&quot;</span></span><br><span class="line">          value=&#123;answer&#125;</span><br><span class="line">          onChange=&#123;onHandleChange&#125;</span><br><span class="line">          placeholder=&#123;<span class="string">&quot;An answer, please...&quot;</span>&#125;</span><br><span class="line">          required</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>That’s it. The test passes by the handler function being called exactly once, with the <strong>mockEvent</strong> object that we passed as the input change event.<br>Let’s commit the changes and move on.</p>
<h3 id="CustomButton-Component"><a href="#CustomButton-Component" class="headerlink" title="CustomButton Component"></a>CustomButton Component</h3><p>For this component, we will skip render and and not render tests. Those are routine, and are available in the project repo.</p>
<p>We will focus on the following three tests:</p>
<ol>
<li>Renders its label correctly</li>
<li>Calls its <strong>onClick</strong> function when clicked</li>
<li>Button is disabled in case current answer state value is invalid</li>
</ol>
<p>As with the ‘Answer’ component, we will set up the test file first.<br>Create <strong>custom-button.test.tsx</strong> in the <strong>src/tests</strong> folder, and inside it import <strong>shallow</strong> from “enzyme” and the <strong>CustomButton</strong> component.<br>We will also create the <strong>setup</strong> function and the <strong>defaultProps</strong> object, and call the <strong>describe</strong> method to create a tests suite.</p>
<p>Note that I have already added the <strong>isNotRenderedProp</strong> inside, to pass the rendering tests that we will not be doing in this post. There are also <strong>primaryColor</strong> and <strong>secondaryColor</strong> props that are used for styling, and are not part of the tests.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\direction-button.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; shallow &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> CustomButton <span class="keyword">from</span> <span class="string">&quot;../components/custom-button.component&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">  primaryColor: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  secondaryColor: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setup = <span class="function">(<span class="params">testProps = defaultProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">CustomButton</span> &#123;<span class="attr">...testProps</span>&#125; /&gt;</span></span>);</span><br><span class="line">  <span class="keyword">return</span> wrapper;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;CustomButton&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="‘Custom-Button’-Component-renders-it-‘label’-prop-correctly"><a href="#‘Custom-Button’-Component-renders-it-‘label’-prop-correctly" class="headerlink" title="‘Custom Button’ Component renders it ‘label’ prop correctly"></a>‘Custom Button’ Component renders it ‘label’ prop correctly</h4><p>The idea here is that the ‘App’ component passes a ‘label’ prop to each instance of the ‘CustomButton’ component. We do have three instances of the ‘CustomButton’ component, so each needs to render its label correctly.</p>
<p>The test is fairly simple. We just needs to create a wrapper, find the button element in the wrapped component, and assert that its contents are equal to the ‘label’ we pass to it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\direction-button.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; shallow &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> CustomButton <span class="keyword">from</span> <span class="string">&quot;../components/custom-button.component&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  label: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  isNotRendered: <span class="literal">false</span>,</span><br><span class="line">  primaryColor: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  secondaryColor: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setup = <span class="function">(<span class="params">testProps = defaultProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">CustomButton</span> &#123;<span class="attr">...testProps</span>&#125; /&gt;</span></span>);</span><br><span class="line">  <span class="keyword">return</span> wrapper;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;CustomButton&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  test(<span class="string">&quot;renders label prop as the button label&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      ...defaultProps,</span><br><span class="line">      label: <span class="string">&quot;Go Back&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">    <span class="keyword">const</span> button = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-direction-button&#x27;]&quot;</span>);</span><br><span class="line">    expect(button.prop(<span class="string">&quot;children&quot;</span>)).toBe(props.label);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>One thing to note:</p>
<ol>
<li>We use <strong>prop(“children”)</strong> to assert that contents of the button will be equal to the value of <strong>props.label</strong>. We could have used the <strong>text()</strong> method on the ‘button’ object again, of course. Back to the** <strong>children</strong> prop, it returns a new wrapper containing all children of the selected element (node). Since we plan to have only a string rendered by the button, this should eventually resolve to true.</li>
</ol>
<p>For now, though, the test throws an error and it fails our test, which is what we expect it to do.</p>
<p>The fix is easy - we make sure that the component expects and renders the <strong>label</strong> prop:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\direction-button.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface CustomButtonProps &#123;</span><br><span class="line">  label: string;</span><br><span class="line">  isNotRendered?: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CustomButton: React.FC&lt;CustomButtonProps&gt; = (&#123;</span><br><span class="line">  isNotRendered,</span><br><span class="line">  label,</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button data-test=<span class="string">&quot;component-direction-button&quot;</span> onClick=&#123;<span class="function">() =&gt;</span> &#123;&#125;&#125;&gt;</span><br><span class="line">        &#123;label&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> CustomButton;</span><br></pre></td></tr></table></figure>

<h4 id="‘CustomButton’-component-calls-its-onClick-function-when-the-‘button’-elemenet-is-clicked"><a href="#‘CustomButton’-component-calls-its-onClick-function-when-the-‘button’-elemenet-is-clicked" class="headerlink" title="‘CustomButton’ component calls its onClick function when the ‘button’ elemenet is clicked"></a>‘CustomButton’ component calls its <strong>onClick</strong> function when the ‘button’ elemenet is clicked</h4><p>All of the button instances of this app will be receving their own click-handler functions:</p>
<ol>
<li>A function to increment local state in the ‘App’ component, to fetch a correct question from Redux state</li>
<li>A function to decrement local state in the ‘App’ component</li>
<li>A function to start a new sentence</li>
</ol>
<p>This test will make sure that the received handler function is actually called when a button instance is clicked.</p>
<p>The test is similar to what we did with the input change handler in the ‘Answer’ component.<br>We pass a spy (a mock function to be used instead of a real handler function) to the ‘CustomButton’ component via props, and find a button in the wrapper, and then we simulate a click event on it. Finally, we assert that the spy function was called once.</p>
<p>Here is the test code:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;calls &#x27;onHandleClick&#x27; prop when button is clicked&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    ...defaultProps,</span><br><span class="line">    onHandleClick: jest.fn(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">  <span class="keyword">const</span> button = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-direction-button&#x27;]&quot;</span>);</span><br><span class="line">  button.simulate(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">  expect(props.onHandleClick).toHaveBeenCalledTimes(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>There is just one thing to note: we do not pass an event object to the <strong>simulate</strong> method. We could do it, but since in this test we don’t use any properties that live in the event object, there is no need to.</p>
<p>Of course, the test fails, as our spy function was not called:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/custom-button.test.tsx (<span class="number">6.075</span> s)</span><br><span class="line"> ● CustomButton › calls <span class="string">&#x27;onHandleClick&#x27;</span> prop when button is clicked</span><br><span class="line"></span><br><span class="line">   expect(jest.fn()).toHaveBeenCalledTimes(expected)</span><br><span class="line"></span><br><span class="line">   Expected number <span class="keyword">of</span> calls: <span class="number">1</span></span><br><span class="line">   Received number <span class="keyword">of</span> calls: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">     <span class="number">50</span> |     <span class="keyword">const</span> button = wrapper.find(<span class="string">&quot;[data-test=&#x27;component-direction-button&#x27;]&quot;</span>);</span><br><span class="line">     <span class="number">51</span> |     button.simulate(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">   &gt; <span class="number">52</span> |     expect(props.onHandleClick).toHaveBeenCalledTimes(<span class="number">1</span>);</span><br><span class="line">        |                                 ^</span><br><span class="line">     <span class="number">53</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/custom-button.test.tsx:<span class="number">52</span>:<span class="number">33</span>)</span><br></pre></td></tr></table></figure>

<p>Issue here is that the component does no expect the <strong>onHandleClick</strong> prop, nor is the prop called when a button is clicked. So le’t change that.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\direction-button.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&quot;styled-components&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface CustomButtonProps &#123;</span><br><span class="line">  label: string;</span><br><span class="line">  onHandleClick: <span class="function">() =&gt;</span> <span class="keyword">void</span>;</span><br><span class="line">  isNotRendered?: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CustomButton: React.FC&lt;CustomButtonProps&gt; = (&#123;</span><br><span class="line">  isNotRendered,</span><br><span class="line">  label,</span><br><span class="line">  onHandleClick,</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button data-test=<span class="string">&quot;component-direction-button&quot;</span> onClick=&#123;onHandleClick&#125;&gt;</span><br><span class="line">        &#123;label&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> CustomButton;</span><br></pre></td></tr></table></figure>

<h4 id="‘CustomButton’s-‘button’-element-is-disabled-when-there-is-no-valid-answer-to-the-current-question"><a href="#‘CustomButton’s-‘button’-element-is-disabled-when-there-is-no-valid-answer-to-the-current-question" class="headerlink" title="‘CustomButton’s ‘button’ element is disabled when there is no valid answer to the current question"></a>‘CustomButton’s ‘button’ element is disabled when there is no valid answer to the current question</h4><p>If a user does not provide a truthy string as an answer, or if there is an empty string in the input of the ‘Answer’ component, we don’t want the ‘CustomButton’ component to be able to call its click handler.<br>As we are currently doing unit testing, we don’t have access to the value of the said input, but we can use props to control behavior of elements in the ‘CustomButton’ component.</p>
<p>Note that we are testing only the instance of the button that submits the answer. This is the one that renders the ‘Next Question’ label on the button, and will eventually be involved in rendering next question each time it is (successfully) clicked.</p>
<p>The test logic is similar to the previous one: we provide props to the component, find the button elment, and the assert that the button itself is disabled.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;&#x27;Next Question&#x27; button is disabled in case of invalid input&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    ...defaultProps,</span><br><span class="line">    label: <span class="string">&quot;Next Question&quot;</span>,</span><br><span class="line">    isInvalidInput: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">  <span class="keyword">const</span> button = wrapper.findWhere(</span><br><span class="line">    (element) =&gt;</span><br><span class="line">      element.type() === <span class="string">&quot;button&quot;</span> &amp;&amp; element.prop(<span class="string">&quot;children&quot;</span>) === props.label</span><br><span class="line">  );</span><br><span class="line">  expect(button.prop(<span class="string">&quot;disabled&quot;</span>)).toBe(<span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>We explicitly specify 2 props that are passed to the wrapper: <strong>label</strong> and <strong>isInvalidInput</strong>. The <strong>label</strong> one is here for clarity sake, and we could do without it. Still, since we are testing that a button with this specific label will be disabled, I find it useful to be there.</li>
<li>The way we find our button element is a bit different than before. Here, we use the <strong>findWhere()</strong> method, which accepts a callback function to which every element in the wrapper is passed. Then, we detail our search criteria in the callback via <strong>type()</strong> and <strong>prop()</strong> methods, to finally find the element we need.</li>
<li>The assertion uses the <strong>disabled</strong> prop via <strong>prop</strong> method, to assert that <strong>disabled</strong> is indeed true.</li>
</ol>
<p>Alas, the <strong>disabled</strong> prop is not true, and the test fails. But that is ok. We make it work easily, by having the component expect the <strong>isInvalidInput</strong> prop, and the ‘button’ element use it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\direction-button.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface CustomButtonProps &#123;</span><br><span class="line">  label: string;</span><br><span class="line">  onHandleClick: <span class="function">() =&gt;</span> <span class="keyword">void</span>;</span><br><span class="line">  isNotRendered?: boolean;</span><br><span class="line">  isInvalidInput?: boolean;</span><br><span class="line">  primaryColor: string;</span><br><span class="line">  secondaryColor: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CustomButton: React.FC&lt;CustomButtonProps&gt; = (&#123;</span><br><span class="line">  isNotRendered,</span><br><span class="line">  label,</span><br><span class="line">  onHandleClick,</span><br><span class="line">  isInvalidInput,</span><br><span class="line">  primaryColor,</span><br><span class="line">  secondaryColor,</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotRendered) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button</span><br><span class="line">        data-test=<span class="string">&quot;component-direction-button&quot;</span></span><br><span class="line">        onClick=&#123;onHandleClick&#125;</span><br><span class="line">        disabled=&#123;isInvalidInput&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;label&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> CustomButton;</span><br></pre></td></tr></table></figure>

<p>Cool. It works. Commit and move on.</p>
<h3 id="Sentence-Component"><a href="#Sentence-Component" class="headerlink" title="Sentence Component"></a>Sentence Component</h3><p>Next up is the ‘Sentence’ component. Tasked with rendering the currently available sentence, it accepts the <strong>sentence</strong> prop and renders it. Simple. It also renders an ellipsis if the game is not over yet.</p>
<p>We will be testing that the component indeed renders the sentence, that it does not render the ellipsis when the game is finished, and that it renders the ellipsis the when sentence is not complete.<br>Again, we skip testing that the component successfully renders. That test is available in the project repo.</p>
<p>Same as before, we need to set up the test. So create a new file in the <strong>src/tests</strong> folder, and call it <strong>sentence.test.tsx</strong>. Inside, we import the ‘Sentence’ component itself, and the ‘shallow’ method from ‘enzyme’.</p>
<p>We also create the <strong>setup</strong> function to be able to easily create a new wrapper for each new test. The function is passed a props object with default props, which it then spreads into the ‘Sentence’ component. Finally, we create a new test suite for our tests.</p>
<p>Here is the whole thing:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\sentence.test.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; shallow &#125; <span class="keyword">from</span> <span class="string">&quot;enzyme&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Sentence <span class="keyword">from</span> <span class="string">&quot;../components/sentence.component&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">  sentence: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  isNotComplete: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setup = <span class="function">(<span class="params">props = defaultProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = shallow(<span class="xml"><span class="tag">&lt;<span class="name">Sentence</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>);</span><br><span class="line">  <span class="keyword">return</span> wrapper;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Sentence&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="‘Sentence’-component-renders-the-existing-sentence"><a href="#‘Sentence’-component-renders-the-existing-sentence" class="headerlink" title="‘Sentence’ component renders the existing sentence"></a>‘Sentence’ component renders the existing sentence</h4><p>First test we do is a simple one. We just want to make sure that the <strong>sentence</strong> prop we pass to the component is rendered properly.<br>For this, we create the prop object with the <strong>sentence</strong> prop, we select the element which is supposed to render the sentence, and then we assert that the element does indeed hold the said prop value.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;renders passed in truthy sentence prop&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    ...defaultProps,</span><br><span class="line">    sentence: <span class="string">&quot;Who does what when&quot;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">  <span class="keyword">const</span> sentence = wrapper.find(<span class="string">&quot;[data-test=&#x27;sentence-span&#x27;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">  expect(sentence.text()).toContain(props.sentence);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>There is just one thing to note: the matcher that we use is <strong>toContain()</strong>. Argument passed to the method is expected to be a part of the value returned from the assertion object. Note that, from what I understand, this only works if the returned assertion object holds primitive values such as strings, numbers, or an array of those. In case we want to check if an assertion object contains an actual JS object, we need to use <strong>toContainEqual()</strong>.</p>
<p>The test fails, of course:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/sentence.test.tsx</span><br><span class="line"> ● Sentence › renders passed <span class="keyword">in</span> truthy sentence prop</span><br><span class="line"></span><br><span class="line">   expect(received).toContain(expected) <span class="comment">// indexOf</span></span><br><span class="line"></span><br><span class="line">   Expected substring: <span class="string">&quot;Who does what when&quot;</span></span><br><span class="line">   Received string:    <span class="string">&quot;Random words here&quot;</span></span><br><span class="line"></span><br><span class="line">     <span class="number">30</span> |     <span class="keyword">const</span> sentence = wrapper.find(<span class="string">&quot;[data-test=&#x27;sentence-span&#x27;]&quot;</span>);</span><br><span class="line">     <span class="number">31</span> |</span><br><span class="line">   &gt; <span class="number">32</span> |     expect(sentence.text()).toContain(props.sentence);</span><br><span class="line">        |                             ^</span><br><span class="line">     <span class="number">33</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/sentence.test.tsx:<span class="number">32</span>:<span class="number">29</span>)</span><br></pre></td></tr></table></figure>

<p>To make it pass, we just need to accept the <strong>sentence</strong> prop in the component, and render it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\sentence.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&quot;styled-components&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface SentenceProps &#123;</span><br><span class="line">  sentence: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Sentence: React.FC&lt;SentenceProps&gt; = <span class="function">(<span class="params">&#123; sentence &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;section data-test=<span class="string">&quot;component-sentence&quot;</span>&gt;</span><br><span class="line">      &lt;h2&gt;Your sentence:&lt;/h2&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;span data-test=<span class="string">&quot;sentence-span&quot;</span>&gt;&#123;sentence&#125;&lt;/span&gt;</span><br><span class="line">        &lt;span data-test=<span class="string">&quot;elipsis-span&quot;</span>&gt;...&lt;/span&gt;</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="‘Sentence’-component-does-not-render-an-ellipsis-when-the-sentence-is-complete"><a href="#‘Sentence’-component-does-not-render-an-ellipsis-when-the-sentence-is-complete" class="headerlink" title="‘Sentence’ component does not render an ellipsis when the sentence is complete"></a>‘Sentence’ component does not render an ellipsis when the sentence is complete</h4><p>As you can see from the component implementation above, we have already coded the ellipsis into it. Now we want to test that the ellipsis will magically disappear when the sentence is complete.</p>
<p>Again, we will do this with props - passing the <strong>isNotComplete</strong> prop to the component to control behavior of the ellipsis.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;does not render elipsis when sentence is complete&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    ...defaultProps,</span><br><span class="line">    sentence: <span class="string">&quot;This is a complete sentence&quot;</span>,</span><br><span class="line">    isNotComplete: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">  <span class="keyword">const</span> elipsis = wrapper.find(<span class="string">&quot;[data-test=&#x27;elipsis-span&#x27;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">  expect(elipsis.length).toBe(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>There is not much to note here. We create the props object, to include both <strong>sentence</strong> and <strong>isNotComplete</strong> props. Value of <strong>false</strong> for the <strong>isNotComplete</strong> prop indicates that the sentece is indeed complete.<br>In the test, we select the ellipsis container (pardon the spelling), and then expect that the length of found elements will be 0.<br>Again, the <strong>sentence</strong> prop is not needed here, but I like to put it for clarity sake.</p>
<p>As expected, the test fails. Instead of our assertion, Jest found exactly 1 element that matches the ‘find’ criteria. Hardly surprising.</p>
<p>Alright, let’s fix this. Only thing we need to do is conditionally render the ellipsis container:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\sentence.component.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&quot;styled-components&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface SentenceProps &#123;</span><br><span class="line">  sentence: string;</span><br><span class="line">  isNotComplete: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Sentence: React.FC&lt;SentenceProps&gt; = <span class="function">(<span class="params">&#123; sentence, isNotComplete &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;section data-test=<span class="string">&quot;component-sentence&quot;</span>&gt;</span><br><span class="line">      &lt;h2&gt;Your sentence:&lt;/h2&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;span data-test=<span class="string">&quot;sentence-span&quot;</span>&gt;&#123;sentence&#125;&lt;/span&gt;</span><br><span class="line">        &#123;isNotComplete &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">data-test</span>=<span class="string">&quot;elipsis-span&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>&#125;</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Now, the ellipsis container will render only when the <strong>isNotComplete</strong> prop is true, which passes our test.</p>
<h4 id="‘Sentence’-component-renders-an-ellipsis-when-the-sentence-is-not-complete"><a href="#‘Sentence’-component-renders-an-ellipsis-when-the-sentence-is-not-complete" class="headerlink" title="‘Sentence’ component renders an ellipsis when the sentence is not complete"></a>‘Sentence’ component renders an ellipsis when the sentence is not complete</h4><p>This test is a reverse of the previous one. In case our <strong>isNotComplete</strong> prop is true, the component should render the ellipsis.<br>In fact, the test should pass with the current setup, but let’s write it anyway.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;renders elipsis when sentence is not complete&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    ...defaultProps,</span><br><span class="line">    isNotComplete: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> wrapper = setup(props);</span><br><span class="line">  <span class="keyword">const</span> elipsis = wrapper.find(<span class="string">&quot;[data-test=&#x27;elipsis-span&#x27;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">  expect(elipsis.length).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Indeed, the test passes. However, since we want the test to fail first, we can change the argument passed to the matcher to make sure that our own actions to affect test results.<br>For instance, if we pass <strong>0</strong> instead of <strong>1</strong> to the <strong>toBe()</strong> matcher, the test fails:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/sentence.test.tsx (<span class="number">5.097</span> s)</span><br><span class="line"> ● Sentence › renders elipsis when sentence is not complete</span><br><span class="line"></span><br><span class="line">   expect(received).toBe(expected) <span class="comment">// Object.is equality</span></span><br><span class="line"></span><br><span class="line">   Expected: <span class="number">0</span></span><br><span class="line">   Received: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">     <span class="number">55</span> |     <span class="keyword">const</span> elipsis = wrapper.find(<span class="string">&quot;[data-test=&#x27;elipsis-span&#x27;]&quot;</span>);</span><br><span class="line">     <span class="number">56</span> |</span><br><span class="line">   &gt; <span class="number">57</span> |     expect(elipsis.length).toBe(<span class="number">0</span>);</span><br><span class="line">        |                            ^</span><br><span class="line">     <span class="number">58</span> |   &#125;);</span><br><span class="line">     <span class="number">59</span> | &#125;);</span><br><span class="line">     <span class="number">60</span> |</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/sentence.test.tsx:<span class="number">57</span>:<span class="number">28</span>)</span><br></pre></td></tr></table></figure>

<p>This is good. It shows that the component behavior does depened on the code we are actually testing.<br>Ok, we pass <strong>1</strong> back as the argument to the matcher, and we commit.</p>
<h3 id="Redux-store-functions-testing"><a href="#Redux-store-functions-testing" class="headerlink" title="Redux store - functions testing"></a>Redux store - functions testing</h3><p>Normally, we would not test behavior of third-packages. These were created by other people who, we assume, did their own tests to make sure everything works.<br>Still, Redux requires reducers and action creators to be created by us, so let’s use this opportunity to test that those actually work property.<br>This also gives us chance to test JS functions instead of React components, since Redux reducers and action creators are just functions.</p>
<p>Setup first:</p>
<ol>
<li>Create <strong>questions.actions.ts</strong> file in <strong>src/store/actions</strong> folder. Inside the file, we draft an action creator called <strong>setAnswerAction</strong>. For now, this action creator returns an empty object.</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\store\actions\set-answer.action.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type ANSWER_TYPE = <span class="string">&quot;WHO&quot;</span> | <span class="string">&quot;WHAT&quot;</span> | <span class="string">&quot;WHEN&quot;</span> | <span class="string">&quot;WHERE&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setAnswerAction = <span class="function">(<span class="params">type: ANSWER_TYPE, answer: string</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Note that we explicitly specify the <strong>type</strong> type to be only four possible strings. These match our questions, and will be passed to the action creator by whichever code calls them. Also, TypeScript provides a more simple way to ensure that the action creator actually returns an object of specific shape. This is done by specifying a return type on the function, and it is done in the final code. Here, though, we are learning to test, so let’s move on with our plan.</p>
<ol start="2">
<li>Similar to above, we create reducer draft in the <strong>questions.reducer.ts</strong> file, in <strong>src/store/reducers</strong> folder. For now, the reducer always returns initial state.</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\store\reducers\questions.reducer.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; ANSWER_TYPE &#125; <span class="keyword">from</span> <span class="string">&quot;../actions/questions.actions&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface QuestionStateObjectInterface &#123;</span><br><span class="line">  question: string;</span><br><span class="line">  answer: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initialState: QuestionStateObjectInterface[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    question: <span class="string">&quot;who&quot;</span>,</span><br><span class="line">    answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    question: <span class="string">&quot;what&quot;</span>,</span><br><span class="line">    answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    question: <span class="string">&quot;when&quot;</span>,</span><br><span class="line">    answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    question: <span class="string">&quot;where&quot;</span>,</span><br><span class="line">    answer: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> questionsReducer = (</span><br><span class="line">  state = initialState,</span><br><span class="line">  action: &#123; <span class="attr">type</span>: ANSWER_TYPE, <span class="attr">payload</span>: string &#125;</span><br><span class="line">) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> questionsReducer;</span><br></pre></td></tr></table></figure>

<p>Thing to note is that we import <strong>ANSWER_TYPE</strong> from our action creator’s module. This is a TypeScriot thing, used for the reducer to know which action types it can accept. Again, this code is different in the final version of the project, where type of the reducer’s <strong>action</strong> argument is a union of all action creators’ return types.</p>
<ol start="3">
<li>Create <strong>redux.test.ts</strong> in <strong>src/tests</strong> folder, and import the action creator and <strong>ANSWER_TYPE</strong> from the <strong>questions.action.ts</strong> module. We also import the reducer from its module, together with the <strong>initialState</strong> array. Finally, we create two suites to be used for the action and reducer testing.</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\redux-actions.test.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  setAnswerAction,</span><br><span class="line">  ANSWER_TYPE,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;../store/actions/questions.actions&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> questionsReducer, &#123;</span><br><span class="line">  initialState,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;../store/reducers/questions.reducer&quot;</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;&#x27;setAnswerAction&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">describe(<span class="string">&quot;&#x27;questionsReducer&#x27;&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="The-action-creator-returns-a-specific-object-when-provided-type-and-answer-arguments"><a href="#The-action-creator-returns-a-specific-object-when-provided-type-and-answer-arguments" class="headerlink" title="The action creator returns a specific object when provided type and answer arguments"></a>The action creator returns a specific object when provided type and answer arguments</h4><p>In this test, we want to check if our action creator will return an object of specific shape. Common practice for action creators is to return objects with <strong>type</strong> and <strong>payload</strong> properties, such as this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: string;</span><br><span class="line">  payload: any;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Our test defines <strong>type</strong> and <strong>answer</strong> properties, passes them to the action creator. It then asserts that the returned object will have a shape of the object shown above.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&quot;&#x27;setAnswerAction&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  test(<span class="string">&quot;returns an action with type &#x27;WHO&#x27;&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> type: ANSWER_TYPE = <span class="string">&quot;WHO&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> answer = <span class="string">&quot;Mark&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> action = setAnswerAction(type, answer);</span><br><span class="line"></span><br><span class="line">    expect(action).toEqual(&#123;</span><br><span class="line">      type: <span class="string">&quot;WHO&quot;</span>,</span><br><span class="line">      payload: <span class="string">&quot;Mark&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The test fails with the following output:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/redux.test.ts</span><br><span class="line"> ● <span class="string">&#x27;setAnswerAction › returns an action with type &#x27;</span>WHO<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   expect(received).toEqual(expected) // deep equality</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   - Expected  - 4</span></span><br><span class="line"><span class="string">   + Received  + 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   - Object &#123;</span></span><br><span class="line"><span class="string">   -   &quot;payload&quot;: &quot;Mark&quot;,</span></span><br><span class="line"><span class="string">   -   &quot;type&quot;: &quot;WHO&quot;,</span></span><br><span class="line"><span class="string">   - &#125;</span></span><br><span class="line"><span class="string">   + Object &#123;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     17 |     const action = setAnswerAction(type, answer);</span></span><br><span class="line"><span class="string">     18 |</span></span><br><span class="line"><span class="string">   &gt; 19 |     expect(action).toEqual(&#123;</span></span><br><span class="line"><span class="string">        |                    ^</span></span><br><span class="line"><span class="string">     20 |       type: &quot;WHO&quot;,</span></span><br><span class="line"><span class="string">     21 |       payload: &quot;Mark&quot;,</span></span><br><span class="line"><span class="string">     22 |     &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     at Object.&lt;anonymous&gt; (src/tests/redux.test.ts:19:20)</span></span><br></pre></td></tr></table></figure>

<p>It is visible that the expected object is not equal to the received one.</p>
<p>To fix this, we can adjust the action creator to return a matching object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\store\actions\set-answer.action.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setAnswerAction = <span class="function">(<span class="params">type: ANSWER_TYPE, answer: string</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    type,</span><br><span class="line">    payload: answer,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>That’s it. The test passes.</p>
<h4 id="The-reducer-returns-correct-state-when-passed-an-action-object"><a href="#The-reducer-returns-correct-state-when-passed-an-action-object" class="headerlink" title="The reducer returns correct state when passed an action object"></a>The reducer returns correct state when passed an action object</h4><p>At this point our reducer always returns the initial state.<br>We want to pass it an action, and make sure that it returns a state that includes payload contained in the action.</p>
<p>In this test, we pass it an action object with <strong>“WHO”</strong> type and answer of <strong>“Mark”</strong>. We then assert that that the returned state will have <strong>“Mark”</strong> as the value of the <strong>answer</strong> property in the <strong>“who”</strong> question object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\tests\redux-actions.test.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  setAnswerAction,</span><br><span class="line">  ANSWER_TYPE,</span><br><span class="line">  setAnswerActionType,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;../store/actions/questions.actions&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> questionsReducer, &#123;</span><br><span class="line">  initialState,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;../store/reducers/questions.reducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;&#x27;questionsReducer&#x27;&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  test(<span class="string">&quot;adjusts WHO state question when matching action is passed to it&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> action = &#123; <span class="attr">type</span>: <span class="string">&quot;WHO&quot;</span>, <span class="attr">payload</span>: <span class="string">&quot;Mark&quot;</span> &#125; <span class="keyword">as</span> &#123; <span class="attr">type</span>: ANSWER_TYPE, <span class="attr">payload</span>: string&#125;;</span><br><span class="line">    <span class="keyword">const</span> testState = initialState.map(<span class="function">(<span class="params">question</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (question.question === <span class="string">&quot;who&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          question: <span class="string">&quot;who&quot;</span>,</span><br><span class="line">          answer: <span class="string">&quot;Mark&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> question;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> reducedState = questionsReducer(<span class="literal">undefined</span>, action);</span><br><span class="line">    expect(reducedState).toEqual(testState);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>The <strong>action</strong> object is cast to a specific shape, to include <strong>ANSWER_TYPE</strong> as the <strong>type</strong> property’s type. This is purely a TS thing. In the final code, an action creator return type is used here.</li>
<li>Reducer’s initial state is used to create test state with <strong>Mark</strong> being the value of the <strong>answer</strong> property for <strong>who</strong> question</li>
<li>We get new state by passing <strong>undefined</strong> and our <strong>action</strong> object to the reducer. By passing <strong>undefined</strong> to the reducer, we make it use its default state.</li>
<li>Finally, we assert that the returned state will equal our test state.</li>
</ol>
<p>The test fails, because there is no logic in the reducer that would actually modify the initial state and put Mark inside it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">FAIL  src/tests/redux.test.ts</span><br><span class="line"> ● <span class="string">&#x27;questionsReducer&#x27;</span> › adjusts WHO state question when matching action is passed to it</span><br><span class="line"></span><br><span class="line">   expect(received).toEqual(expected) <span class="comment">// deep equality</span></span><br><span class="line"></span><br><span class="line">   - Expected  - <span class="number">1</span></span><br><span class="line">   + Received  + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">   @@ <span class="number">-1</span>,<span class="number">8</span> +<span class="number">1</span>,<span class="number">8</span> @@</span><br><span class="line">     <span class="built_in">Array</span> [</span><br><span class="line">       <span class="built_in">Object</span> &#123;</span><br><span class="line">   -     <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;Mark&quot;</span>,</span><br><span class="line">   +     <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">         <span class="string">&quot;question&quot;</span>: <span class="string">&quot;who&quot;</span>,</span><br><span class="line">       &#125;,</span><br><span class="line">       <span class="built_in">Object</span> &#123;</span><br><span class="line">         <span class="string">&quot;answer&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">         <span class="string">&quot;question&quot;</span>: <span class="string">&quot;what&quot;</span>,</span><br><span class="line"></span><br><span class="line">     <span class="number">38</span> |</span><br><span class="line">     <span class="number">39</span> |     <span class="keyword">const</span> reducedState = questionsReducer(<span class="literal">undefined</span>, action);</span><br><span class="line">   &gt; <span class="number">40</span> |     expect(reducedState).toEqual(testState);</span><br><span class="line">        |                          ^</span><br><span class="line">     <span class="number">41</span> |   &#125;);</span><br><span class="line"></span><br><span class="line">     at <span class="built_in">Object</span>.&lt;anonymous&gt; (src/tests/redux.test.ts:<span class="number">40</span>:<span class="number">26</span>)</span><br></pre></td></tr></table></figure>

<p>So let’s make the test pass:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\store\reducers\questions.reducer.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> questionsReducer = (</span><br><span class="line">  state = initialState,</span><br><span class="line">  action: &#123; <span class="attr">type</span>: ANSWER_TYPE, <span class="attr">payload</span>: string &#125;</span><br><span class="line">) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;WHO&quot;</span>:</span><br><span class="line">      <span class="keyword">const</span> whoState = state.map(<span class="function">(<span class="params">question</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (question.question === <span class="string">&quot;who&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123;</span><br><span class="line">            question: <span class="string">&quot;who&quot;</span>,</span><br><span class="line">            answer: action.payload,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> question;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> whoState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Things to note:</p>
<ol>
<li>For brevity sake, we only code for <strong>“WHO”</strong> type. Final code has all cases coded.</li>
</ol>
<p>Commit, please.</p>
<p>Great. We finish the post by having our Redux function tested.<br>In the next post we will do integration testins, where we test interaction between multiple components. So we will have a button click and then see what is going on in the ‘Sentence’ component.<br>To accomplish this, we will use a <strong>mount</strong> method instead of <strong>shallow</strong>. <strong>mount</strong> renders components in full, together with their nested components. It does take more memory, but it also provides access to the whole component tree.</p>
<p>See you there.</p>
<!-- End Step Content -->

<!-- Project Information -->

<h2 id="Project-Information"><a href="#Project-Information" class="headerlink" title="Project Information"></a>Project Information</h2><h3 id="Available-at"><a href="#Available-at" class="headerlink" title="Available at"></a>Available at</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ikaem/sentence-game">Github repository</a></li>
<li><a target="_blank" rel="noopener" href="https://sentence-game.herokuapp.com/">Live website</a></li>
</ul>
<h3 id="Goals"><a href="#Goals" class="headerlink" title="Goals"></a>Goals</h3><ol>
<li>Use Jest and Enzyme to write an app with TDD approach</li>
<li>Make all tests pass and make the app work</li>
</ol>
<h3 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h3><ol>
<li><strong>Setup and unit testing</strong></li>
<li>Integration testing</li>
</ol>
<h3 id="Tech-and-Tools"><a href="#Tech-and-Tools" class="headerlink" title="Tech and Tools"></a>Tech and Tools</h3><ul>
<li>React</li>
<li>TypeScript</li>
<li>Jest</li>
<li>Enzyme</li>
<li>Styled Components</li>
</ul>
<h3 id="Experience-with-Tech-amp-Tools"><a href="#Experience-with-Tech-amp-Tools" class="headerlink" title="Experience with Tech &amp; Tools"></a>Experience with Tech &amp; Tools</h3><p>I have no experience with React testing, aside from going over couple of tutorials online. At this point I am experimenting and have decided to go with Enzyme for this series, as it was the first testing library I did a course on.</p>
<h2 id="DISCLAIMER"><a href="#DISCLAIMER" class="headerlink" title="DISCLAIMER"></a>DISCLAIMER</h2><p>Don’t take any of this seriously and as a matter-of-fact. These are my notes. It might look like I am trying to teach something to someone. I am not.</p>
<p>Also, this post, and the whole blog, is not meant for a codealong. This is my notebook, and I learn these things by writing about them.<br>While I try to structure posts and organize them in a way that they build on previous posts’ progress, I can’t promise that they will include all details needed for the code to work. There is just too much of it, and I might omit things for brevity sake, or because I forgot something, or because I am not well organized, or because I changed my mind and reworked the code at the end of a blog series.</p>


                


                <!-- Cover image credit -->
                
                    <p class="image-credit-link">
                        Cover image by <strong>
                            <a target="_blank" rel="noopener" href="https://unsplash.com/@lukejonesdesign?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">
                                Luke Jones
                            </a>
                        </strong>
                    </p>

                

  

            </div>
            
            <!-- Custom placed tags -->
            <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                
                    


<a href="/angry-chaired-blog/tags/react/">#react</a> <a href="/angry-chaired-blog/tags/testing/">#testing</a> <a href="/angry-chaired-blog/tags/jest/">#jest</a> <a href="/angry-chaired-blog/tags/enzyme/">#enzyme</a> <a href="/angry-chaired-blog/tags/test-driven-development/">#test driven development</a>


                
            </div>
            <!--  -->



            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            

            <!-- Hyvor comments -->

            <!-- End of Hyvor comments -->
        </div>
    </div>
</article>



    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2020 kaem<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>